---
import { Icon } from 'astro-icon/components'
import { getLangFromUrl, useTranslations } from '../i18n/utils'

const lang = getLangFromUrl(Astro.url)
const t = useTranslations(lang)

interface Props {
  package: string
}

const { package: packageName } = Astro.props

const response = await fetch(
  `https://api.npmjs.org/downloads/point/last-week/${packageName}`,
)
const data = await response.json()
const downloads = data.downloads.toLocaleString()
---

<a
  href={`https://www.npmjs.com/package/${packageName}`}
  class="flex items-center"
  target="_blank"
  rel="noreferrer"
>
  <Icon name="mdi:npm-variant-outline" class="h-6" />
  <small class="ml-1"
    >{downloads} {t('site.downloads')} ({t('site.last_week')})</small
  >
</a>
